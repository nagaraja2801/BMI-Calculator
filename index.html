<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BMI Calculator</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <link rel="icon" type="image/png" sizes="32x32" href="favicon.png" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f4f8;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      padding: 1rem;
    }
    .container {
      background: white;
      padding: 2rem;
      border-radius: 8px;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
      width: 360px;
      max-width: 100%;
      text-align: center;
    }
    h2 {
      margin-bottom: 1rem;
      position: relative;
    }
    label {
      display: block;
      text-align: left;
      font-weight: 600;
      margin-bottom: 0.25rem;
      margin-top: 0.5rem;
    }
    input, select {
      width: 100%;
      padding: 8px;
      margin-bottom: 0.25rem;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 1rem;
      box-sizing: border-box;
    }
    .error {
      color: #d93025;
      font-size: 0.85rem;
      height: 18px;
      margin-bottom: 0.5rem;
    }
    button {
      background-color: #007BFF;
      color: white;
      border: none;
      padding: 10px 0;
      width: 100%;
      font-size: 1rem;
      border-radius: 4px;
      cursor: pointer;
      margin-top: 1rem;
      transition: background-color 0.3s ease;
    }
    button:hover {
      background-color: #0056b3;
    }
    .result, #healthTips, #idealWeightTable {
      margin-top: 1rem;
      font-size: 1rem;
    }
    .result.visible, #healthTips.visible, #idealWeightTable.visible {
      opacity: 1;
    }
    .underweight { color: #0275d8; }
    .normal { color: #28a745; }
    .overweight {
      color: #856404;
      background-color: #fff3cd;
      padding: 0.2em 0.5em;
      border-radius: 4px;
      display: inline-block;
    }
    .obese { color: #dc3545; }
    table {
      margin: 1rem auto;
      border-collapse: collapse;
      width: 100%;
      max-width: 300px;
    }
    table, th, td {
      border: 1px solid #ccc;
    }
    th, td {
      padding: 6px;
      text-align: center;
    }
    canvas {
      margin-top: 1rem;
      max-width: 100%;
    }
    #bmiChart-container {
      position: relative;
      height: 300px;
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>BMI Calculator</h2>
    <label for="weight">Weight</label>
    <input type="number" id="weight" placeholder="Enter weight" step="0.1">

    <label for="unit">Unit</label>
    <select id="unit" onchange="updatePlaceholders()">
      <option value="metric">kg/m</option>
      <option value="imperial">lbs/in</option>
    </select>

    <label for="height">Height</label>
    <input type="number" id="height" placeholder="Enter height" step="0.01">

    <div id="weight-error" class="error"></div>
    <div id="height-error" class="error"></div>

    <button onclick="calculateBMI()">Calculate BMI</button>
    <div id="result" class="result"></div>
    <div id="healthTips"></div>
    <div id="idealWeightTable"></div>
    <div id="bmiChart-container">
      <canvas id="bmiChart"></canvas>
    </div>
  </div>

  <script>
    function updatePlaceholders() {
      const unit = document.getElementById('unit').value;
      const weightInput = document.getElementById('weight');
      const heightInput = document.getElementById('height');
      if (unit === 'metric') {
        weightInput.placeholder = 'Enter weight in kg';
        heightInput.placeholder = 'Enter height in meters';
      } else {
        weightInput.placeholder = 'Enter weight in lbs';
        heightInput.placeholder = 'Enter height in inches';
      }
    }

    function calculateBMI() {
      const weight = parseFloat(document.getElementById('weight').value);
      const height = parseFloat(document.getElementById('height').value);
      const unit = document.getElementById('unit').value;

      if (!weight || weight <= 0) {
        document.getElementById('weight-error').textContent = "Enter valid weight.";
        return;
      } else document.getElementById('weight-error').textContent = "";

      if (!height || height <= 0) {
        document.getElementById('height-error').textContent = "Enter valid height.";
        return;
      } else document.getElementById('height-error').textContent = "";

      let bmi;
      if (unit === "metric") {
        bmi = weight / (height * height);
      } else {
        bmi = (weight / (height * height)) * 703;
      }

      let category = '', className = '';
      if (bmi < 18.5) { category = 'Underweight'; className = 'underweight'; }
      else if (bmi < 25) { category = 'Normal weight'; className = 'normal'; }
      else if (bmi < 30) { category = 'Overweight'; className = 'overweight'; }
      else { category = 'Obese'; className = 'obese'; }

      document.getElementById('result').textContent = `Your BMI is ${bmi.toFixed(2)} (${category})`;
      document.getElementById('result').className = `result visible ${className}`;

      const tips = {
        underweight: "Consider gaining weight with nutrient-rich foods.",
        normal: "Maintain your healthy habits!",
        overweight: "Increase physical activity and monitor diet.",
        obese: "Consult a healthcare provider for weight management."
      };
      document.getElementById('healthTips').textContent = tips[className];
      document.getElementById('healthTips').className = 'visible';

      let min = 18.5 * height * height;
      let max = 24.9 * height * height;
      if (unit === 'imperial') {
        min = min / 703;
        max = max / 703;
      }
      document.getElementById('idealWeightTable').innerHTML =
        `<table><tr><th>Ideal Weight Range</th></tr><tr><td>${min.toFixed(1)} - ${max.toFixed(1)} ${unit === 'metric' ? 'kg' : 'lbs'}</td></tr></table>`;
      document.getElementById('idealWeightTable').className = 'visible';

      drawChart(bmi);
    }

    function drawChart(bmi) {
      const ctx = document.getElementById('bmiChart').getContext('2d');
      if (window.bmiChart) window.bmiChart.destroy();
      window.bmiChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: ['Underweight', 'Normal', 'Overweight', 'Obese'],
          datasets: [{
            label: 'BMI Range',
            data: [18.5, 24.9, 29.9, 40],
            backgroundColor: ['#0275d8', '#28a745', '#ffc107', '#dc3545']
          }, {
            label: 'Your BMI',
            data: [0, 0, 0, 0],
            backgroundColor: ['#6c757d']
          }]
        },
        options: {
          responsive: true,
          plugins: {
            title: { display: true, text: 'BMI Categories' },
            legend: { display: true, labels: { usePointStyle: true } }
          },
          scales: {
            y: { beginAtZero: true }
          }
        }
      });
      const categoryIndex = bmi < 18.5 ? 0 : bmi < 25 ? 1 : bmi < 30 ? 2 : 3;
      window.bmiChart.data.datasets[1].data[categoryIndex] = bmi;
      window.bmiChart.update();
    }

    window.onload = updatePlaceholders;
  </script>
</body>
</html>
